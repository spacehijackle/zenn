---
title: "Swing 宣言的UI化計画！①"
emoji: "️🚀️"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: [ "Java", "Swing", "GUI" ]
published: false
---

## 序章
`Java`の`Swing`が世に登場してから30年近く。既にデスクトップのGUIフレームとしてはすっかり影が薄くなってしまいましたが、その惨状は当時熱心に学んだ私からすると、とても寂しいものです。その後、新たなGUIフレームワーク`JavaFX`が登場したものの、これを使ったアプリを見ることはほぼありません。気づけば標準SDKの同梱からも外れるという憂き目に合っていて、もはや`Java`のGUIフレームワークが活躍できる場所は皆無、と言っても良いかもしれません（Oracleのインストーラはまだ`Java`なんですかね？）。

そんな状況にある中、私は仕事で`SwiftUI`に触れ、それまでの命令的UI, もしくは`XML`で組み立てる従来方式からGUI構築が新たな局面に突入したことを実感しました。そして思い出したのが`Swing`。スペルもめちゃ似てるじゃないですか、`Swift`と。`Swing`が宣言的UI化されれば、`JAVAer`の方々も手軽にGUIをいじれるようになるのではないか？と期待するところでしたが、公式からは何のアナウンスもなし。まぁ、冷静に考えて`Java`の文法だと宣言的UI化するのは難しいところもあるのは分かります。なので、この記事では「もしも`Swing`が宣言的UI化されたら？」を実験的に試みようと思います。ただ、私自身はGUI技術の深いところまで精通しているワケではないので、温かい目で見守ってくれたら幸いです🤗

一応、以前の記事のリンクを貼っておきますが、「SwingUI 爆誕！」と題した記事で、簡単なサンプルを載せています。また記事の最後の動画ではお手製`SwingUI`で作成したアプリの様子も公開しています。

https://zenn.dev/spacehijackle/articles/2c701299df1fed


## 宣言的UI化するのに必要なこと
世には`Swift`の他にも`Kotlin`や`Flutter(Dart)`でも宣言的UIが採用されていますが、目指すのは`SwiftUI`です。これはデフォルト引数がサポートされていない`Java`では、それが前提の`Kotlin`や`Flutter`のようには記述できない、というのが一番の理由です。ちなみに私は現在`Flutter`でスマホアプリを作っていますが、余白を後から追加するのも結構面倒なんですよね。ツールの機能を使えば良いのですが、ちょっとね…

```Dart
  @override
  Widget build(BuildContext context) {
    return MaterialApp (
      home: Scaffold (
        appBar: AppBar (
          title: Text('Flutter サンプル'),
        ),
        body: Center (
          // Paddingウィジェットで子要素の周囲に余白を設定
          child: Padding (
            padding: EdgeInsets.all(8.0),
            child: Row (  // 垂直方向に並べる
              children: [
                Text (
                  'Flutter Sample',
                  style: TextStyle(fontSize: 18),
                ),
                Column (  // 水平方向に並べる
                  children: [
                    Text("Item1"),
                    Text("Item2"),
                  ],
                ),
              ],
            ),
          ),
        ),
      ),
    );
  }
```

やっぱり、このような入れ子構造は見づらいです。それに子要素に一々`child`って引数のラベル指定を書かないといけないとか、私にはムダが多いように見えます（何でインデントが2桁なんだ…）。本当は`Flutter`で書くのを止めたいくらいなのですが、`Hot Reload`が便利過ぎて… （にしても、末尾の`)`や`]`の連続が気にならなかったのか？設計者さん！）

まぁ、いいでしょう。ここでグチることでもありません。一方、`SwiftUI`は以下のような感じです。

```Swift
    var body: some View
    {
        VStack  // 垂直方向に並べる
        {
            Text("SwiftUI Sample")
                .font(.title)
                .padding()  // 周囲に余白

            HStack  // 水平方向に並べる
            {
                Text("Item 1")
                Text("Item 2")
            }
        }
    }
```

`.font()`や`.padding()`は基本的にメソッドチェーンによって実現されています。メソッドチェーンとは`StringBuilder`で見る、アレです。

```Java
StringBuilder sb = new StringBuilder();
sb.append("一行目\n")
  .append("二行目\n")
  .append("三行目\n");
```

`Swing`では基本的にボタン等のGUI部品は`JComponent`という上位クラスを継承していますが、この`JComponent`を各メソッドが返す、という操作を想定しています。ちなみに`StringBuilder`は`append(String)`等のメソッドは、自身のクラスのメソッドを連続して呼び出せるよう、`StringBuilder`を返却しています。これと同じ仕組みです。

それと前提として、もちろん`Swing`の基礎知識がある方が良いのですが、まぁとりあえずいいでしょう。必要があれば、都度説明します（たぶん）。


## まずは縦横並びのレイアウトから
基本中の基本、レイアウトから実現していきます。レイアウトとは、GUI部品を並べていくベースとなるもので、`Swing`だと、例えば`FlowLayout`や`BorderLayout`等があります。前者はこのレイアウトを設定した後、ボタン等GUI部品を載せると横並びに並べてくれます（表示しきれなくなったら改行）。後者は中心をメインとし、その周りに上下左右にGUI部品を並べるレイアウトです。

![](https://docs.oracle.com/javase/tutorial/figures/uiswing/layout/BorderLayoutDemo.png =450x)
*Oracleの[BorderLayout説明チュートリアル](https://docs.oracle.com/javase/tutorial/uiswing/layout/border.html)より抜粋*

このようにレイアウトはGUI部品を意図通りに並べるためのベースです。先に挙げた`SwiftUI`の例のように縦並び（垂直方向並び）、横並び（水平方向並び）にするのに適した`Swing`のレイアウトは`BoxLayout`でしょう。

![](https://docs.oracle.com/javase/tutorial/figures/uiswing/layout/BoxLayoutDemo.png =250x)
*Oracleの[BoxLayout説明チュートリアル](https://docs.oracle.com/javase/tutorial/uiswing/layout/box.html)より抜粋*

さて、GUI部品を並べるレイアウトは理解できたとして、それではそのレイアウトをどこに設定するのか？という疑問が生じるでしょう。基本的に`Swing`の作りはウィンドウを表す`JFrame`とその中に配置される`JPanel`が存在します。大枠が`JFrame`で、その中で区画を区切るのが`JPanel`です（`JPanel`自体は単なる背景だけの存在であり、具体的には上図のグレー部分と考えてください）。

上記の`BoxLayout`で例えると、フレーム枠が`JFrame`で、その中が`JPanel`であり、その`JPanel`に`BoxLayout`が設定されることで、ボタンが縦に並んでいる（この例では区画は一つ）、と解釈すれば、とりあえず良いでしょう。ちなみに縦並びの中で横並びを実現するには途中のボタンを`JPanel`に入れ替え（`JPanel`もGUI部品のひとつ）、その`JPanel`のレイアウト（下図、黄色部分）に横並びの`BoxLayout`のレイアウトを設定し、その上にボタンを並べるわけなんですが（この場合、区画は２つ）、イメージできたでしょうか？

![](/images/articles/afbf49830d82f8/VStackButtons.jpg =350x)
*縦並びの中に横並びの`BoxLayout`*
